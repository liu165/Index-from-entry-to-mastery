# 数据库索引从入门到精通

## 一.为什么要用索引

答：加快select查询速度，如果不能够在sql语句上进行优化的话，那就在条件处加上索引，他可以让运行几十秒sql，加上索引后变得0.几秒运行，不过这是一种以空间换时间的做法，他会牺牲掉数据库的内存换取查询的速度。

## 二 怎么用索引

### 1.关于什么字段要加索引，什么字段不该加索引，一个表最多能加几个索引的回答

答：

**那些字段可以建立索引呢**

1. 在经常用作过滤器的字段上建立索引（如where)；

2. 在SQL语句中经常进行GROUP BY、ORDER BY的字段上建立索引；

3. 在连接查询的where条件处使用索引； 

4. 在经常存取的多个列上建立复合索引，但要注意复合索引的建立顺序要按照使用的频度来确定；（ps：不太明白）

5. 缺省情况下建立的是非簇集索引，但在以下情况下最好考虑簇集索引，如：含有有限数目（不是很少）唯一的列；进行大范围的查询；充分的利用索引可以减少表扫描I/0的次数，有效的避免对整表的搜索。当然合理的索引要建立在对各种查询的分析和预测中，也取决于DBA的所设计的数据库结构。 （ps：这句话我也不懂）

   **那些字段避免建立索引呢**

   1.在不同值较少的字段上不必要建立索引，如性别字段

   2.对于经常存取的列避免建立索引；

   3 字段类型值较大的字段建议不要用 ，如text

**一个表最多建立几个索引呢**

我看过一篇博客，文中说索引的个数不易过多，最多不能超过6个，如果超过了，优先把一下如没在where，group，on ，order条件处的索引优先去掉。

## 2.索引具体怎么用

1.如图

![1566366518622](C:\Users\me\AppData\Local\Temp\1566366518622.png)



## 3怎么查看sql语句用没用到索引呢

这里提到sql中的一个关键字：explain  执行计划

![1566366865522](C:\Users\me\AppData\Local\Temp\1566366865522.png)

type  这是重要的列，显示连接使用了何种类型。从最好到最差的连接类型为const、eq_reg、ref、range、indexhe和ALL 



key  实际使用的索引。如果为NULL，则没有使用索引。很少的情况下，MYSQL会选择优化不足的索引。这种情况下，可以在SELECT语句中使用USE INDEX（indexname）来强制使用一个索引或者用IGNORE INDEX（indexname）来强制MYSQL忽略索引 

**值得一提的是设置为主键的主键字段默认设置为唯一索引，因此主键不需要再建立索引**

ref  显示索引的哪一列被使用了，如果可能的话，是一个常数 



Extra  关于MYSQL如何解析查询的额外信息。将在表4.3中讨论，但这里可以看到的坏的例子是Using temporary和Using filesort，意思MYSQL根本不能使用索引，结果是检索会很慢 

Impossible WHERE noticed after reading const tables

Using index condition; Using where 使用的适应，再where条件处使用了索引

## 关于索引的一些补充

MySQL索引的建立对于MySQL的高效运行是很重要的，索引可以大大提高MySQL的检索速度。

打个比方，如果合理的设计且使用索引的MySQL是一辆兰博基尼的话，那么没有设计和使用索引的MySQL就是一个人力三轮车。

拿汉语字典的目录页（索引）打比方，我们可以按拼音、笔画、偏旁部首等排序的目录（索引）快速查找到需要的字。

索引分单列索引和组合索引。单列索引，即一个索引只包含单个列，一个表可以有多个单列索引，但这不是组合索引。组合索引，即一个索引包含多个列。

创建索引时，你需要确保该索引是应用在	SQL 查询语句的条件(一般作为 WHERE 子句的条件)。

实际上，索引也是一张表，该表保存了主键与索引字段，并指向实体表的记录。

上面都在说使用索引的好处，但过多的使用索引将会造成滥用。因此索引也会有它的缺点：虽然索引大大提高了查询速度，同时却会降低更新表的速度，如对表进行INSERT、UPDATE和DELETE。因为更新表时，MySQL不仅要保存数据，还要保存一下索引文件。

建立索引会占用磁盘空间的索引文件。